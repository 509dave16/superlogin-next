'use strict';module.exports=function(a){var b={error:'Forbidden',message:'You do not have permission to access this resource.',status:403},c={error:'superlogin',message:'requireAuth must be used before checking roles',status:500};return{requireAuth:function(b,c,d){a.authenticate('bearer',{session:!1})(b,c,d)},requireRole:function(a){return function(d,e,f){if(!d.user)return f(c);var g=d.user.roles;g&&g.length&&-1!==g.indexOf(a)?f():(e.status(b.status),e.json(b))}},requireAnyRole:function(a){return function(d,e,f){if(!d.user)return f(c);var g=!0,h=d.user.roles;if(h&&h.length)for(var j=0;j<a.length;j++)-1!==h.indexOf(a[j])&&(g=!1);g?(e.status(b.status),e.json(b)):f()}},requireAllRoles:function(a){return function(d,e,f){if(!d.user)return f(c);var g=!1,h=d.user.roles;if(!h||!h.length)g=!0;else for(var j=0;j<a.length;j++)-1===h.indexOf(a[j])&&(g=!0);g?(e.status(b.status),e.json(b)):f()}}}};